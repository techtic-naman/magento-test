<?php /** * Copyright Â© MageWorx. All rights reserved. * See LICENSE.txt for license details. */ ?> <?php /** @var \MageWorx\XReviewBase\Block\Review\Product\ListView $block */ $ratings = $block->getRatings(); $overallRating = $block->getOverallRating(); /** @var \Magento\Review\Model\Review[] $items */ $items = $block->getReviewsCollection()->getItems(); $format = $block->getDateFormat() ?: \IntlDateFormatter::SHORT; ?> <?php if (count($items)) : ?> <div id="customer-reviews"><?= $block->getChildHtml('review_summary'); ?> <div class="mw-grid"><div class="mw-grid__item mw-grid__item--secondary mw-reviews-meta"><div class="mw-text mw-text--size-l mw-reviews-meta__heading"><?= $block->escapeHtml(__('Customer Reviews')) ?></div><?php if ($block->isFormLinkAllowed()): ?> <a class="mw-action primary mw-reviews-meta__action" href="#review-form"><?= $block->escapeHtml(__('Write a Review')) ?></a> <?php endif; ?> <?php if ($block->isDisplayRewardMessage()): ?> <div class="mw-text mw-reward-message"><?= $block->escapeHtml($block->getRewardMessage(), ['span']) ?></div><?php endif; ?></div><div class="mw-grid__item"><div class="mw-rating-filter"><div class="mw-rating-filter__overall"><div class="mw-rating-filter__sum mw-text mw-text--size-xxl mw-text--variation-strong"><?= (float)$overallRating['rating_summary'] ?>/5</div><div class="mw-rating-filter__count mw-text"><?= $block->escapeHtml( __('Based on %count reviews', ['count' => (int)$overallRating['reviews_count']]) ) ?></div></div><ul class="mw-rating-filter__detailed"><?php foreach ($ratings as $rating): ?> <li class="mw-rating-filter__item"><div class="mw-rating-filter__stars mw-rating-filter__stars--<?= $block->escapeHtmlAttr($rating['style_suffix']) ?>"></div><div class="mw-rating-filter__graph"><div class="mw-rating-filter__graph-value" style="width: <?= (int)$rating['percent'] ?>%"></div></div><div class="mw-rating-filter__score mw-text"><?= (int)$rating['percent'] ?>%(<?= (int)$rating['stage_count'] ?>)</div></li> <?php endforeach; ?></ul></div></div></div><div class="mw-grid mw-sorting"></div><?= $block->getChildHtml('toolbar') ?> <div class="mw-reviews"><?php foreach ($items as $review): ?> <div class="mw-grid" itemscope itemprop="review" itemtype="http://schema.org/Review"><div class="mw-grid__item mw-grid__item--secondary mw-reviews__user"><div class="mw-user"><div class="mw-user__content"><div class="mw-user__name mw-text mw-text--size-md"><?= $block->escapeHtml($review->getNickname()) ?></div><?php if ($block->allowLocation($review)) : ?> <div class="mw-country"><div class="mw-country__location mw-text mw-text--variation-subdued"><?= /* @noEscape */ $review->getLocationText() ?></div></div><?php endif; ?> <?php if ($block->allowVerifiedLabel($review)) : ?> <div class="mw-verified-buyer"><?= $block->escapeHtml(__('Verified Buyer')) ?></div><?php endif; ?> <?php if ($block->allowRecommendLabel($review)) : ?> <div class="mw-recommend"><?= $block->escapeHtml(__('Recommend')) ?></div><?php endif; ?></div></div></div><div class="mw-grid__item mw-review"><div class="mw-text mw-text--size-md mw-text--variation-strong mw-review__title" itemprop="name"><?= $block->escapeHtml($review->getTitle()) ?></div><div class="mw-text mw-text--variation-subdued mw-review__date" itemprop="datePublished" datetime="<?= $block->escapeHtmlAttr( $block->formatDate($review->getCreatedAt(), $format) ) ?>"><?= $block->escapeHtml($block->formatDate($review->getCreatedAt(), $format)) ?></div><?php if (count($review->getRatingVotes())): ?> <?php foreach ($review->getRatingVotes() as $vote): ?> <div class="mw-rating mw-review__rating"><div class="mw-rating__label mw-text"><?= $block->escapeHtml($vote->getRatingCode()) ?></div><div class="mw-rating__result"><meta itemprop="worstRating" content="1"/><meta itemprop="bestRating" content="100"/><div class="mw-rating__stars" aria-hidden="true"><div class="mw-rating__stars-value" style="width:<?= $block->escapeHtmlAttr($vote->getPercent()) ?>%"></div></div><div class="mw-rating__text"><?= $block->escapeHtmlAttr($vote->getPercent()) ?>%</div></div></div><?php endforeach; ?> <?php endif; ?> <div class="mw-text mw-review__text" itemprop="description"><?= /* @noEscape */ nl2br($block->escapeHtml($review->getDetail())) ?></div><?php if ($block->allowMediaGallery($review)): ?> <div class="mw-gallery mw-review__photos"><?php foreach ($review->getMediaGallery() as $mediaItem): ?> <a class="mw-gallery__item" href="<?= $block->escapeUrl($mediaItem->getMediaUrl()) ?>" data-fslightbox="gallery" data-thumb="<?= $block->escapeUrl($mediaItem->getThumbnailMediaUrl()) ?>"><img src="<?= $block->escapeUrl($mediaItem->getThumbnailMediaUrl()) ?>" alt="<?= $block->escapeHtmlAttr($mediaItem->getLabel()) ?>"/></a> <?php endforeach; ?></div><?php endif; ?> <?php if ($block->isEnableProsAndCons($review)): ?> <div class="mw-grid mw-review__pros-and-cons"><div class="mw-grid__item mw-grid__item--half"><div class="mw-pros"><?= /* @noEscape */ nl2br($block->escapeHtml($review->getPros())) ?></div></div><div class="mw-grid__item mw-grid__item--half"><div class="mw-cons"><?= /* @noEscape */ nl2br($block->escapeHtml($review->getCons())) ?></div></div></div><?php endif; ?> <?php if ($block->isDisplayHelpful()): ?> <div class="mw-review__meta" data-index="<?= (int)$review->getId() ?>" data-mage-init='{"vote":<?= /* @noEscape */ $block->getJsonVoteConfig() ?>}'><input type="hidden" name="form_key" value="<?= $block->escapeHtmlAttr($block->getFormKey()) ?>" /><div class="mw-text mw-text--variation-subdued mw-review__meta-text"><?= $block->escapeHtml(__('Review helpful?')) ?></div><div class="mw-rate mw-review__meta-rate-like"><button class="mw-rate__icon" aria-label="Like"><svg fill="currentColor" width="19" height="15" viewBox="0 0 19 19" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="m3.99998 9.54075-3.49998.00001v7.00004h3.49998m0-7.00005c.5-.66667 1.99983-1.99992 3-2.5.8-.4 1.66667-2.49993 2-3.99993 0-1 0-2 .5-2s2.50002-.500003 2.50002 2c0 2-.5 3-1 3.99993 1.1666-.16667 3.8-.4 5 0s1.5 1.5 1 2.5c.3333.49995 1 1.49995 0 2.49995.5 1 .5 2-.5 3 0 1 0 2-2 2.5-1.6.4-7.83335-.6665-10.50002-.9999m0-7.00005v7.00005" stroke="#000" stroke-linejoin="round"/></svg></button> <div class="mw-rate__count">0</div></div><div class="mw-rate mw-review__meta-rate-dislike"><button class="mw-rate__icon mw-rate__icon--dislike" aria-label="Dislike"><svg fill="currentColor" height="15" viewBox="0 0 19 19" width="19" xmlns="http://www.w3.org/2000/svg"><path d="m3.99998 9.08846-3.499981-.00001v-7.00009l3.499981.00002m0 7.00008c.5.66667 1.99983 1.99994 3 2.50004.8.4 1.66667 2.4999 2 3.9999 0 1 0 2 .5 2s2.50002.5 2.50002-2c0-2-.5-3-1-3.9999 1.1666.1666 3.8.4 5 0s1.5-1.5 1-2.50004c.3333-.5 1-1.5 0-2.5.5-1 .5-2-.5-3 0-1 0-1.99999-2-2.49999-1.6-.400001-7.83336.66658-10.50002.99991m0 7.00008v-7.00008" stroke="#000" stroke-linejoin="round"/></svg></button> <div class="mw-rate__count">0</div></div></div><?php endif; ?> <?php if ($review->getAnswer()): ?> <div class="mw-review__reply"><div class="mw-text mw-text--size-md mw-review__reply-heading"><?= $block->escapeHtml(__('Brand reply')) ?></div><div class="mw-text mw-review__reply-content"><?= /* @noEscape */ nl2br($block->escapeHtml($review->getAnswer())) ?></div></div><?php endif; ?></div></div><?php endforeach; ?></div><div class="toolbar review-toolbar"><?= $block->getToolbar() ? $block->getToolbar()->getPagerHtml() : '' ?></div></div><?php if ($block->getReviewCharactersLimit()) : ?> <script type="text/x-magento-init">
            {
                ".mw-review__text": {
                    "MageWorx_XReviewBase/js/show-more-less": {
                        "characters_limit": <?= (int)$block->getReviewCharactersLimit() ?>,
                        "show_less_label": "<?= $block->escapeJs(__('Show less')) ?>",
                        "show_more_label": "<?= $block->escapeJs(__('Show more')) ?>"
                    }
                }
            }</script><?php endif; ?> <script type="text/x-magento-init">
    {
        "*": {
            "xReviewGallery": {}
        }
    }</script><?php elseif ($block->isDisplayRewardMessage()): ?> <div class="mw-text mw-reward-message"><?= $block->escapeHtml($block->getRewardMessage(), ['span']) ?></div><?php endif; ?>