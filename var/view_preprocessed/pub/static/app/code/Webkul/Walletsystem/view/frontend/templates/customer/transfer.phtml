<?php /** * Webkul Software. * * @category Webkul * @package Webkul_Walletsystem * @author Webkul * @copyright Webkul Software Private Limited (https://webkul.com) * @license https://store.webkul.com/license.html */ ?> <?php $viewModel = $block->getViewModel(); $helper = $viewModel->getHelper(); if ($helper->getWalletenabled()) { $status = 0; $customerId = $helper->getCustomerId(); $currency_code = $helper->getCurrentCurrencyCode(); $transferPayee = $block->getEnabledPayeeCollection(); ?> <div class="wk_ws_main"><div class='wk_ws_main_head'><div class="wk_ws_sub_head1"><img src='<?= $escaper->escapeUrl($block->getViewFileUrl( 'Webkul_Walletsystem::images/wallet.png' ));?>' width="70px" height="55px"></div><div class="wk_ws_sub_head2"><div class="wk_ws_sub_head_details"><h2><?=$escaper->escapeHtml(__('Wallet Details'));?></h2><h3><span class="wk_ws_price"><?=$escaper->escapeHtml($block->getWalletRemainingTotal($customerId))?></span> <?= $escaper->escapeHtml("(".$currency_code.")")?></h3><span><?=$escaper->escapeHtml(__("Your Wallet Balance"))?></span></div><div class="wk_ws_sub_add_payee button action primary"><span><?=$escaper->escapeHtml(__("Add Payee"))?></span></div></div></div><div class='wk_ws_body'><?php if ($transferPayee->getSize()) { ?> <form action="<?=$escaper->escapeUrl($block->getUrl('walletsystem/transfer/sendCode/'))?>" enctype="multipart/form-data" method="post" id="transfer-form-data" class="form"><input type="hidden" name="sender_id" value="<?= $escaper->escapeHtmlAttr($customerId)?>"/><fieldset class='wk_ws_fieldset fieldset'><label class="error"></label> <?=/*@noEscape*/ $block->getBlockHtml('formkey')?> <div class='field required'><label class="label required" for="reciever_id"><span> <?=$escaper->escapeHtml(__('Select Payee To Whom You want to transfer Amount')); ?></span></label> <select name="reciever_id" id="reciever_id" class="required"><option value=""><?=$escaper->escapeHtml(__("Please Select a payee"))?></option><?php foreach ($transferPayee as $payee) { $customerData = $block->getCustomerDataById($payee->getPayeeCustomerId()); ?> <option value="<?= $escaper->escapeHtmlAttr($payee->getPayeeCustomerId())?>"><?=$escaper->escapeHtml($payee->getNickName(). " (".$customerData->getEmail().")")?></option><?php } ?></select></div><div class="field required"><label class="label required" for="amount"><span> <?=$escaper->escapeHtml(__("Amount"))?> <?= $escaper->escapeHtml("(".$currency_code.")")?></span></label> <div class="control"><input type="text" name="amount" id="amount" class="required validate-number validate-greater-than-zero"></div></div><div class="field"><label class="label" for="amount"><span> <?=$escaper->escapeHtml(__("Note"))?></span></label> <div class="control"><textarea name="walletnote"></textarea></div></div><div><button type="submit" title="<?=$escaper->escapeHtml(__("Transfer Money to Customer"))?>" class="button wk_ws_add_payment action primary"><span><span><?=$escaper->escapeHtml(__("Transfer Money to Customer"))?></span></span></button></div></fieldset></form><?php } else { ?> <span><?=$escaper->escapeHtml(__("No Payee is available"))?></span> <?php }?></div><div class='wk_ws_table'><h3><?=$escaper->escapeHtml(__('Added Payees'))?></h3><?php $walletPayeeCollection = $block->getWalletPayeeCollection(); if (count($walletPayeeCollection)): ?> <div class='table-wrapper'><table class="data table walletorder data table"><thead><tr><th scope="col" class="col nickname"><?=$escaper->escapeHtml(__('Nick name'))?></th><th scope="col" class="col email"><?=$escaper->escapeHtml(__('Email address'))?></th><th scope="col" class="col status"><?=$escaper->escapeHtml(__('Status'))?></th><th scope="col" class="col action"><?=$escaper->escapeHtml(__('Action'))?></th></tr></thead><tbody><?php foreach ($walletPayeeCollection as $payee): $customerEmail = $block->getCustomerDataById($payee->getPayeeCustomerId())->getEmail(); ?> <tr><td data-th="<?=$escaper->escapeHtml(__("Nick name"))?>" class="col nickname"><?=$escaper->escapeHtml($payee->getNickName())?></td><td data-th="<?=$escaper->escapeHtml(__("Email"))?>" class="col email"><?=$escaper->escapeHtml($customerEmail)?></td><td data-th="<?=$escaper->escapeHtml(__("Status"))?>" class="col status"><?=$escaper->escapeHtml($payee->getStatus()?__('Approved'):__('Pending'))?></td><td data-th="Action" class="col action"><span class="label wk_action"><span> <i class="fa fa-pencil-square-o payee_edit" aria-hidden="true" data-id="<?= $escaper->escapeHtmlAttr($payee->getEntityId());?>" data-url = " <?=$escaper->escapeUrl($block->getUrl( 'walletsystem/transfer/payeeedit/', [ 'id'=>$payee->getEntityId(), '_secure' => $block->getIsSecure() ] )) ?>" title="<?=$escaper->escapeHtml(__('Edit'))?>"></i> <i class="fa fa-check payee_update" aria-hidden="true" style="display:none" data-id="<?= $escaper-> escapeHtmlAttr($payee->getEntityId());?>" data-url = " <?= $escaper->escapeUrl( $block->getUrl( 'walletsystem/transfer/payeeupdate/', [ 'id'=>$payee->getEntityId(), '_secure' => $block->getIsSecure() ] ) ) ?>" title="<?=$escaper->escapeHtml(__('Update'))?>"></i></span> <span> <i class="fa fa-trash payee_delete" aria-hidden="true" title="<?=$escaper->escapeHtml(__('Delete'))?>" data-url = " <?= $escaper->escapeUrl( $block->getUrl( 'walletsystem/transfer/payeedelete/', [ 'id'=>$payee->getEntityId(), '_secure' => $block->getIsSecure() ] ) ) ?>" login-url=" <?= $escaper->escapeUrl( $block->getUrl( 'customer/account/login' ) );?>" data-id=" <?= $escaper->escapeHtmlAttr( $payee->getEntityId() );?>"></i> <i class="fa fa-remove payee_cancel" aria-hidden="true" style="display:none" title="<?=$escaper->escapeHtml(__('Cancel'))?>"></i></span></span></td></tr><?php endforeach; ?></tbody></table></div><?php if ($block->getPagerHtml()): ?> <div class="order-transaction-toolbar toolbar bottom"><?= $block->getPagerHtml(); ?></div><?php endif ?> <?php else: ?> <h5><?=$escaper->escapeHtml(__('No records found!'));?></h5><?php endif; ?></div></div><div class="wk_ws_add_payee_modal" style="display:none"><form id="walletsystem_add_payee" method="post" action=" <?=$escaper->escapeUrl($block->getUrl( 'walletsystem/transfer/addpayee', ['_secure' => $block->getIsSecure()] ))?>"><input type="hidden" name="customer_id" value="<?= $escaper->escapeHtmlAttr($customerId)?>" /><div class="fieldset" ><div class="wk_msg_notification"><h4></h4></div><div class="field required"><label class="label" for="nickname"><?=$escaper->escapeHtml(__("Nick name")); ?></label> <input type="text" id="nickname" name="nickname" class="nickname" data-validate="{required:true}"/></div><div class="field required"><label class="label" for="customer_email"><?=$escaper->escapeHtml(__("Email Address")); ?></label> <input type="text" id="customer_email" name="customer_email" class="customer_email" data-validate="{required:true, 'validate-email':true}"/></div><div class="field required"><label class="label" for="confirm-email"><?=$escaper->escapeHtml(__("Confirm Email Address")); ?></label> <input type="text" id="confirm-email" name="confirm-email" class="confirm-email" data-validate="{required:true, 'validate-email':true, equalTo:'#customer_email'}"/></div></div></form></div><?php }?> <script type="text/x-magento-init">
{
    "*":{
        "Wkwalletcustom":{}
    }
}</script>