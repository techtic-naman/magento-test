<?php /** * Copyright Â© 2015 Magento. All rights reserved. * See COPYING.txt for license details. */ use Magento\Framework\App\Action\Action; ?> <?php /** * Product list template * * @var $block \Smartwave\Filterproducts\Block\ */ ?> <?php $_productCollection = $block->getLoadedProductCollection(); $_helper = $this->helper('Magento\Catalog\Helper\Output'); $_imagehelper = $this->helper('Magento\Catalog\Helper\Image'); $_portohelper = $this->helper('Smartwave\Porto\Helper\Data'); $_category_config = $_portohelper->getConfig('porto_settings/category'); $_category_grid_config = $_portohelper->getConfig('porto_settings/category_grid'); $_product_label_config = $this->helper('Smartwave\Porto\Helper\Data')->getConfig('porto_settings/product_label'); $_content_pos1 = isset($_category_grid_config['product_content_pos1']) ? $_category_grid_config['product_content_pos1'] : 'left'; $_button_pos = isset($_category_grid_config['product_button_pos']) ? $_category_grid_config['product_button_pos'] : 'top'; $_button_action = isset($_category_grid_config['product_button_action']) ? $_category_grid_config['product_button_action'] : 'top'; $_icon_only1 = isset($_category_grid_config['product_icon_only1']) ? $_category_grid_config['product_icon_only1'] : '0'; $_icon_only2 = isset($_category_grid_config['product_icon_only2']) ? $_category_grid_config['product_icon_only2'] : '0'; $_block_pos = isset($_category_grid_config['product_block_pos']) ? $_category_grid_config['product_block_pos'] : 'default'; $_quantity_pos = isset($_category_grid_config['product_quantity_pos']) ? $_category_grid_config['product_quantity_pos'] : 'below'; $_content_pos2 = isset($_category_grid_config['product_content_pos2']) ? $_category_grid_config['product_content_pos2'] : 'default'; $_link_pos = isset($_category_grid_config['product_link_pos']) ? $_category_grid_config['product_link_pos'] : 'default'; $_box_style = isset($_category_grid_config['product_box_style']) ? $_category_grid_config['product_box_style'] : 'box_shadow'; $aspect_ratio = $this->getData("aspect_ratio"); if($aspect_ratio == null) { $aspect_ratio = $_category_config['aspect_ratio']; } $image_width = $this->getData("image_width"); if(!$image_width) { $image_width = ($_category_config['ratio_width'])?$_category_config['ratio_width']:300; } $image_height = $this->getData("image_height"); if(!$image_height) { $image_height = ($_category_config['ratio_height'])?$_category_config['ratio_height']:300; } $column_count = $this->getData("column_count"); if($column_count == null) { $column_count = 4; } $product_count = $this->getData("product_count"); $category_id = $this->getData("category_id"); $product_type = $_category_grid_config['product_type']; if($product_type == null) { $product_type = 1; } ?> <?php if (!$_productCollection->count()): ?> <div class="message info empty"><div><?php echo __('We can\'t find products matching the selection.') ?></div></div><?php else: ?> <?php $viewMode = 'grid'; $image = 'category_page_grid'; $hover_image = 'category_page_grid-hover'; $showDescription = false; $templateType = \Magento\Catalog\Block\Product\ReviewRendererInterface::SHORT_VIEW; ?> <div class="products wrapper <?php echo $viewMode; ?> columns<?php echo $column_count; ?> products-<?php echo $viewMode; ?> <?php if($product_type == 2): ?>no-padding divider-line<?php endif; ?> <?php if($product_type == 5 || $product_type == 6 || $product_type == 7 || $product_type == 8): ?>no-padding<?php endif; ?> <?php if($product_type == 6): ?>divider-line<?php endif; ?>"><?php $iterator = 1; ?> <ol class="filterproducts products list items product-items"><?php /** @var $_product \Magento\Catalog\Model\Product */ ?> <?php foreach ($_productCollection as $_product): ?> <?php echo($iterator++ == 1) ? '<li class="item product product-item">' : '</li><li class="item product product-item">' ?> <?php $newType = array("13", "14", "15", "16", "17", "18", "19", "20"); $_type_class = ''; $_content_pos1 = ''; if(in_array($product_type, $newType)) { $_content_pos1 = ' text-'.$_content_pos1; $_type_class = ' product-type-advanced'; if($product_type == '15'){ $_type_class = ' product-type-advanced effect-ovdefault'; if($_button_action == 'top'){ $_content_pos1 = ' text-center'; } if($_button_action == 'hide'){ $_content_pos1 = ' text-center hide-actions'; } } if($product_type == '16'){ $_type_class = ' product-type-advanced effect-hddf'.' box-'.$_block_pos; } if($product_type == '18'){ $_type_class = ' product-type-advanced effect-detailimg'; $_content_pos1 = ' text-left'; if($_content_pos2 == 'top'){ $_type_class = ' product-type-advanced effect-detailimg actions-bottom'; } if($_content_pos2 == 'center'){ $_content_pos1 = ' text-center'; $_type_class = ' product-type-advanced effect-detailimg actions-center'; } if($_content_pos2 == 'bottom'){ $_type_class = ' product-type-advanced effect-detailimg actions-top'; } } if($product_type == '19'){ $_type_class = ' product-type-advanced effect-cartlink'; if($_link_pos == 'image') { $_type_class = ' product-type-advanced effect-cartlink cartlink-image'; } $_content_pos1 = ' text-left'; } if($product_type == '20'){ $_content_pos1 = ' text-center'; if($_box_style == 'box_shadow') { $_type_class .= ' product-type-advanced effect-bheshadow'; } if($_box_style == 'box_full') { $_type_class .= ' product-type-advanced effect-bhesfd'; $_content_pos1 = ' text-left'; } if($_box_style == 'box_border') { $_type_class .= ' product-type-advanced effect-bheborder'; } if($_box_style == 'box_border_padding') { $_type_class .= ' product-type-advanced effect-bhebrspace'; } } } ?> <div class="product-item-info type<?php echo $product_type; ?><?= $_content_pos1;?> porto-tb-item type-product has-post-thumbnail product-type-simple" data-container="product-grid"><div class="porto-section<?=$_type_class?> p-0"><?php if($product_type == '20' && $_box_style == 'box_full'):?><div class="content-shadow"></div><?php endif;?> <?php ?> <div class="product photo product-item-photo<?php if(in_array($product_type, $newType)):?> porto-tb-featured-image tb-image-type-hover<?php endif;?> product-image"><div class="porto-tb-featured-image tb-image-type-hover"><a href="<?php echo $_product->getProductUrl() ?>" tabindex="-1"><?php if($aspect_ratio) $productImage = $_imagehelper->init($_product, $image)->constrainOnly(FALSE)->keepAspectRatio(TRUE)->keepFrame(FALSE)->resize($image_width); else $productImage = $_imagehelper->init($_product, $image)->resize($image_width, $image_height); $productImageUrl = $productImage->getUrl(); ?> <img class="product-image-photo default_image" src="<?php echo $productImageUrl; ?>" alt="<?php echo $productImage->getLabel(); ?>"/><?php if($_category_config['alternative_image']): ?> <?php if($aspect_ratio) $productHoverImage = $_imagehelper->init($_product, $hover_image)->constrainOnly(FALSE)->keepAspectRatio(TRUE)->keepFrame(FALSE)->resize($image_width); else $productHoverImage = $_imagehelper->init($_product, $hover_image)->resize($image_width, $image_height); $productHoverImageUrl = $productHoverImage->getUrl(); ?> <?php if($productImageUrl != str_replace("/thumbnail/","/small_image/",$productHoverImageUrl)): ?> <img class="product-image-photo hover_image" src="<?php echo $productHoverImageUrl; ?>" alt="<?php echo $productHoverImage->getLabel(); ?>"/><?php endif; ?> <?php endif; ?></a> <?php $product_label = ""; if($_product_label_config['sale_label']) { if ($percentage = $_portohelper->getPercentage($_product)) { if($_product_label_config['sale_label_percent']) { $product_label .= '<div class="product-label sale-label">'.$percentage.'%'.'</div>'; } else { $product_label .= '<div class="product-label sale-label">'.$_product_label_config['sale_label_text'].'</div>'; } } } if($_product_label_config['new_label']) { $now = date("Y-m-d"); $newsFrom= substr($_product->getData('news_from_date')?$_product->getData('news_from_date'):'',0,10); $newsTo= substr($_product->getData('news_to_date')?$_product->getData('news_to_date'):'',0,10); if ($newsTo != '' || $newsFrom != ''){ if (($newsTo != '' && $newsFrom != '' && $now>=$newsFrom && $now<=$newsTo) || ($newsTo == '' && $now >=$newsFrom) || ($newsFrom == '' && $now<=$newsTo)) { $product_label .= '<div class="product-label new-label">'.$_product_label_config['new_label_text'].'</div>'; } } } if($product_label) echo '<div class="product-labels">'.$product_label.'</div>'; ?> <?php $_show_actions_top = false; $_product_inner_class = ''; if(in_array($product_type, ['3','5','6','7','8','9','11','13','14','15','16','17','18','19','20'])) { $_show_actions_top = true; if($product_type == 14 && $_button_pos == 'outside'){ $_show_actions_top = false; } if($product_type >= 13){ $_product_inner_class = ' tb-hover-content with-link'; } if($product_type == 13 || ($product_type == 15 && $_button_action == 'top') || $product_type == 16 || $product_type == 17 || $product_type == 19) { $_product_inner_class .= ' css-bottom-iconcart icon-absolute'; } if($product_type == 14 && $_icon_only1){ $_product_inner_class .= ' show-cart-icon'; } if($product_type == 14 && $_button_pos != 'outside'){ $_product_inner_class .= ' button-pos-'.$_button_pos; } if($product_type == 15 && $_icon_only2 && $_button_action != 'top'){ $_product_inner_class .= ' show-cart-icon'; } if($product_type == 15 && $_button_action != 'top') { $_product_inner_class .= ' button-pos-center'; } if($product_type == 18) { $_product_inner_class .= ' icon-absolute show-cart-icon'; } if($product_type == 20 && $_box_style != 'box_full') { $_product_inner_class .= ' css-bottom-iconcart icon-absolute'; } if($product_type == 20 && $_box_style == 'box_full'){ $_show_actions_top = false; } } if($_show_actions_top): ?> <div class="product-item-inner<?= $_product_inner_class;?>"><?php if(in_array($product_type, $newType)):?> <a aria-label="post content" href="<?php echo $_product->getProductUrl() ?>" class="porto-tb-link"></a> <?php endif;?> <?php if($product_type == 15 || $product_type == 16 || $product_type == 18):?> <?php if(($product_type == 15 && $_button_action == 'center') || ($product_type == 18 && $_content_pos2 == 'default') || ($product_type == 18 && $_content_pos2 == 'center')):?> <div class="porto-section content-top"><?php $_productNameStripped = $block->stripTags($_product->getName(), null, true); ?> <strong class="product name product-item-name"><a class="product-item-link" href="<?php echo $_product->getProductUrl() ?>"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name'); ?></a></strong> <?php if($_category_config['rating_star']): ?> <?php $review_html = $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php if($review_html): ?> <?php echo $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php else: ?> <div class="product-reviews-summary short"><div class="rating-summary"><span class="label"><span>Rating:</span></span> <div class="rating-result" title="0%"><span style="width:0"><span>0%</span></span></div></div></div><?php endif; ?> <?php endif; ?></div><?php endif; ?> <div class="product details product-item-details porto-section<?php if($_button_action == 'top' || $_button_action == 'hide' || $product_type == 16):?> product-content<?php endif;?><?php if($product_type == 15 && $_button_action == 'center'):?> content-bottom<?php endif;?><?php if($product_type == 16 && $_block_pos == 'full'):?> d-flex justify-content-center flex-column<?php endif;?>"><?php if($_button_action == 'top' || $_button_action == 'hide' || $product_type == 16 || ($product_type == 18 && $_content_pos2 == 'top') || ($product_type == 18 && $_content_pos2 == 'bottom')):?> <?php $_productNameStripped = $block->stripTags($_product->getName(), null, true); ?> <strong class="product name product-item-name"><a class="product-item-link" href="<?php echo $_product->getProductUrl() ?>"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name'); ?></a></strong> <?php if($_category_config['rating_star']): ?> <?php $review_html = $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php if($review_html): ?> <?php echo $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php else: ?> <div class="product-reviews-summary short"><div class="rating-summary"><span class="label"><span>Rating:</span></span> <div class="rating-result" title="0%"><span style="width:0"><span>0%</span></span></div></div></div><?php endif; ?> <?php endif; ?> <?php endif;?> <?php if($_category_config['product_price']): ?> <?php echo $block->getProductPrice($_product) ?> <?php endif; ?> <?php echo $block->getProductDetailsHtml($_product); ?> <?php if($product_type == 16):?> <div class="actions-primary"><?php if ($_product->isSaleable()): ?> <?php $postParams = $block->getAddToCartPostParams($_product); ?> <form data-role="tocart-form" action="<?php echo $postParams['action']; ?>" method="post"><input type="hidden" name="product" value="<?php echo $postParams['data']['product']; ?>"><input type="hidden" name="<?php echo Action::PARAM_NAME_URL_ENCODED; ?>" value="<?php echo $postParams['data'][Action::PARAM_NAME_URL_ENCODED]; ?>"><?php echo $block->getBlockHtml('formkey')?> <button type="submit" title="<?php echo $block->escapeHtml(__('Add to Cart')); ?>" class="action tocart primary"><span><?php echo __('Add to Cart') ?></span></button></form><?php else: ?> <?php if ($_product->getIsSalable()): ?> <div class="stock available"><span><?php echo __('In stock') ?></span></div><?php else: ?> <div class="stock unavailable"><span><?php echo __('Out of stock') ?></span></div><?php endif; ?> <?php endif; ?></div><?php endif;?></div><?php endif; ?> <div class="product actions product-item-actions<?php if($product_type == 14 || ($product_type == 15 && $_button_action != 'top') || $product_type == 16 || $product_type == 17):?> d-flex align-items-center justify-content-center<?php endif;?><?php if($product_type == 17 && $_quantity_pos == 'image_center'):?> actions-center<?php endif;?>"><?php $c_show_cart = false; if($product_type != 16){ $c_show_cart = true; } if($product_type == 17 && ($_quantity_pos =='below' || $_quantity_pos =='above')) { $c_show_cart = false; } if($product_type == 19 && $_link_pos != 'image') { $c_show_cart = false; } ?> <?php if($c_show_cart):?> <div class="actions-primary"><?php if ($_product->isSaleable()): ?> <?php $postParams = $block->getAddToCartPostParams($_product); ?> <form data-role="tocart-form" action="<?php echo $postParams['action']; ?>" method="post" class="d-flex flex-column flex-sm-row"><input type="hidden" name="product" value="<?php echo $postParams['data']['product']; ?>"><input type="hidden" name="<?php echo Action::PARAM_NAME_URL_ENCODED; ?>" value="<?php echo $postParams['data'][Action::PARAM_NAME_URL_ENCODED]; ?>"><?php if($product_type == 17 && ($_quantity_pos == 'image_bottom' || $_quantity_pos == 'image_center')):?> <div class="qty-box"><a href="javascript:void(0)" class="qtyminus"><i class="porto-icon-minus"></i></a> <input type="text" name="qty" id="qty" maxlength="12" value="<?php echo ($this->getMinimalQty($_product)?$this->getMinimalQty($_product):1) ?>" title="<?php /* @escapeNotVerified */ echo __('Qty') ?>" class="input-text qty" data-validate="<?php echo $block->escapeHtml(json_encode($block->getQuantityValidators())) ?>"/><a href="javascript:void(0)" class="qtyplus"><i class="porto-icon-plus"></i></a></div><?php endif;?> <?php echo $block->getBlockHtml('formkey')?> <button type="submit" title="<?php echo $block->escapeHtml(__('Add to Cart')); ?>" class="action tocart primary"><span><?php echo __('Add to Cart') ?></span></button></form><?php else: ?> <?php if ($_product->getIsSalable()): ?> <div class="stock available"><span><?php echo __('In stock') ?></span></div><?php else: ?> <div class="stock unavailable"><span><?php echo __('Out of stock') ?></span></div><?php endif; ?> <?php endif; ?></div><?php endif;?> <?php if ($block->getMode() == 'grid'): ?> <?php if ($this->helper('Magento\Wishlist\Helper\Data')->isAllow()): ?> <a href="#" class="action towishlist actions-secondary" title="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" aria-label="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" data-post='<?php echo $block->getAddToWishlistParams($_product); ?>' data-action="add-to-wishlist" role="button"><span><?php echo __('Add to Wish List') ?></span></a> <?php endif; ?> <?php endif; ?> <?php if($_category_config['addtocompare']): ?> <?php $compareHelper = $this->helper('Magento\Catalog\Helper\Product\Compare'); ?> <a href="#" class="action tocompare actions-secondary" title="<?php echo $block->escapeHtml(__('Add to Compare')); ?>" aria-label="<?php echo $block->escapeHtml(__('Add to Compare')); ?>" data-post='<?php echo $compareHelper->getPostDataParams($_product); ?>' role="button"><span><?php echo __('Add to Compare') ?></span></a> <?php endif; ?></div></div><?php endif; ?></div></div><?php if($product_type != '15' && $product_type != 16 && $product_type != '18'): ?> <div class="product details product-item-details porto-section product-content<?php if($product_type == '17' && $_quantity_pos =='above'):?> qty-above d-flex flex-column align-items-center<?php endif;?><?php if($product_type == '19' && ($_link_pos == 'top' || $_link_pos == 'hidden')){?> show-cartlink-top<?php }?>"><?php $_productNameStripped = $block->stripTags($_product->getName(), null, true); ?> <?php if($product_type == '13' || $product_type == '14' || $product_type == '19' || $product_type == '20'): ?> <?php echo $block->getProductDetailsHtml($_product); ?> <?php endif;?> <strong class="product name product-item-name"><a class="product-item-link" href="<?php echo $_product->getProductUrl() ?>"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name'); ?></a></strong> <?php ?> <?php if($_category_config['rating_star']): ?> <?php $review_html = $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php if($review_html): ?> <?php echo $block->getReviewsSummaryHtml($_product, $templateType); ?> <?php else: ?> <div class="product-reviews-summary short"><div class="rating-summary"><span class="label"><span>Rating:</span></span> <div class="rating-result" title="0%"><span style="width:0"><span>0%</span></span></div></div></div><?php endif; ?> <?php endif; ?> <?php if ($showDescription):?> <div class="product description product-item-description"><?php echo $_helper->productAttribute($_product, $_product->getShortDescription(), 'short_description') ?> <a href="<?php echo $_product->getProductUrl() ?>" title="<?php echo $_productNameStripped ?>" class="action more"><?php echo __('Learn More') ?></a></div><?php endif; ?> <?php if($_category_config['product_price']): ?> <?php echo $block->getProductPrice($_product) ?> <?php endif; ?> <?php if($product_type != '13' && $product_type != '14' && $product_type != '19' && $product_type != '20'): ?> <?php echo $block->getProductDetailsHtml($_product); ?> <?php endif; ?> <?php $_product_show_actions = true; $_product_details_inner_class = ''; if(in_array($product_type, ['3','5','6','7','8','9','11','13','14','17','19','20'])) { $_product_show_actions = false; if($product_type == '14' && $_button_pos =='outside'){ $_product_show_actions = true; $_product_details_inner_class .= ' button-pos'.$_button_pos; } if($product_type == '14' && $_icon_only1 ) { $_product_details_inner_class .= ' show-cart-icon'; } if($product_type == '17' && ($_quantity_pos =='below' || $_quantity_pos =='above')){ $_product_show_actions = true; } if($product_type == '19' && ($_link_pos == 'default' || $_link_pos == 'top')){ $_product_show_actions = true; } if($product_type == '20' && $_box_style == 'box_full'){ $_product_show_actions = true; } } if($_product_show_actions): ?> <div class="product-item-inner<?=$_product_details_inner_class;?>"><?php if($product_type == '20' && $_box_style == 'box_full'){?> <div class="product description product-item-description"><?php $length = 118; $shortContent = $_product->getShortDescription(); echo $shortContent = strip_tags((strlen($shortContent) > $length) ? substr($shortContent,0,$length).'...' : $shortContent); ?></div><?php }?> <div class="product actions product-item-actions<?php if(($product_type == '14' && $_button_pos == 'outside') || ($product_type == '20' && $_box_style == 'box_full')):?> d-flex align-items-center justify-content-center<?php endif;?>"><?php if ($block->getMode() == 'grid'): ?> <?php if($_category_config['addtowishlist'] && $product_type != '4' && $product_type != '17' && $product_type != '19'): ?> <?php if ($this->helper('Magento\Wishlist\Helper\Data')->isAllow()): ?> <a href="#" class="action towishlist actions-secondary" title="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" aria-label="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" data-post='<?php echo $block->getAddToWishlistParams($_product); ?>' data-action="add-to-wishlist" role="button"><span><?php echo __('Add to Wish List') ?></span></a> <?php endif; ?> <?php endif; ?> <?php endif; ?> <div class="actions-primary"><?php if ($_product->isSaleable()): ?> <?php $postParams = $block->getAddToCartPostParams($_product); ?> <form data-role="tocart-form" action="<?php echo $postParams['action']; ?>" method="post" class="d-flex flex-column flex-sm-row"><input type="hidden" name="product" value="<?php echo $postParams['data']['product']; ?>"><input type="hidden" name="<?php echo Action::PARAM_NAME_URL_ENCODED; ?>" value="<?php echo $postParams['data'][Action::PARAM_NAME_URL_ENCODED]; ?>"><?php if($product_type == 10 || $product_type == 17):?> <div class="qty-box"><a href="javascript:void(0)" class="qtyminus"><i class="porto-icon-minus"></i></a> <input type="text" name="qty" id="qty" maxlength="12" value="<?php echo ($this->getMinimalQty($_product)?$this->getMinimalQty($_product):1) ?>" title="<?php /* @escapeNotVerified */ echo __('Qty') ?>" class="input-text qty" data-validate="<?php echo $block->escapeHtml(json_encode($block->getQuantityValidators())) ?>"/><a href="javascript:void(0)" class="qtyplus"><i class="porto-icon-plus"></i></a></div><?php endif;?> <?php echo $block->getBlockHtml('formkey')?> <button type="submit" title="<?php echo $block->escapeHtml(__('Add to Cart')); ?>" class="action tocart primary"><span><?php echo __('Add to Cart') ?></span></button></form><?php else: ?> <?php if ($_product->getIsSalable()): ?> <div class="stock available"><span><?php echo __('In stock') ?></span></div><?php else: ?> <div class="stock unavailable"><span><?php echo __('Out of stock') ?></span></div><?php endif; ?> <?php endif; ?></div><?php if ($block->getMode() == 'grid' && $product_type != '17' && $product_type != '19'): ?> <?php if($_category_config['addtowishlist'] && $product_type == 4): ?> <?php if ($this->helper('Magento\Wishlist\Helper\Data')->isAllow()): ?> <a href="#" class="action towishlist actions-secondary" title="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" aria-label="<?php echo $block->escapeHtml(__('Add to Wish List')); ?>" data-post='<?php echo $block->getAddToWishlistParams($_product); ?>' data-action="add-to-wishlist" role="button"><span><?php echo __('Add to Wish List') ?></span></a> <?php endif; ?> <?php endif; ?> <?php endif; ?> <?php if($_category_config['addtocompare'] && $product_type != '17' && $product_type != '19'): ?> <?php $compareHelper = $this->helper('Magento\Catalog\Helper\Product\Compare'); ?> <a href="#" class="action tocompare actions-secondary" title="<?php echo $block->escapeHtml(__('Add to Compare')); ?>" aria-label="<?php echo $block->escapeHtml(__('Add to Compare')); ?>" data-post='<?php echo $compareHelper->getPostDataParams($_product); ?>' role="button"><span><?php echo __('Add to Compare') ?></span></a> <?php endif; ?></div></div><?php endif; ?></div><?php endif;?></div></div><?php echo($iterator == count($_productCollection)+1) ? '</li>' : '' ?> <?php endforeach; ?></ol><div style="clear:both;"></div><?php if($product_count == count($_productCollection)): ?> <div class="load-more-area"><p class="ajax-loader-area" style="margin: 40px 0;display: none;"><i class="ajax-loader large animate-spin"></i></p><a href="javascript:void(0)" cat_id="<?php echo $category_id; ?>" product_count="<?php echo $product_count + $column_count; ?>"><?php echo __("Load More"); ?></a></div><?php endif; ?></div><script type="text/javascript">
        require([
            'jquery', 'weltpixel_quickview'
        ], function ($, quickview) {
            <?php if($product_type == '20'){?>
              window.setTimeout(function(){
                $( '.product-item-info .effect-bhesfd' ).each( function() {
                    var $item = $( this ),
                        $detail = $item.find( '.product-item-details .product-item-inner' ),
                        height = $item.height() + $detail.height() + 32;
                    $item.find( '>.content-shadow' ).height( height );
                    $( window ).on( 'resize', function() {
                        $detail = $item.find( '.product-item-details .product-item-inner' );
                        height = $item.height() + $detail.height() + 32;
                        $item.find('>.content-shadow').height( height );
                    } );
                });
              },500);
            <?php }?> $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(2n)').addClass('nth-child-2n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(2n+1)').addClass('nth-child-2np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(3n)').addClass('nth-child-3n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(3n+1)').addClass('nth-child-3np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(4n)').addClass('nth-child-4n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(4n+1)').addClass('nth-child-4np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(5n)').addClass('nth-child-5n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(5n+1)').addClass('nth-child-5np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(6n)').addClass('nth-child-6n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(6n+1)').addClass('nth-child-6np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(7n)').addClass('nth-child-7n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(7n+1)').addClass('nth-child-7np1');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(8n)').addClass('nth-child-8n');
            $('.main .products.grid .product-items.filterproducts li.product-item:nth-child(8n+1)').addClass('nth-child-8np1');
            $('.weltpixel-quickview').off('click').on('click', function() {
                var prodUrl = $(this).attr('data-quickview-url');
                if (prodUrl.length) {
                    quickview.displayContent(prodUrl);
                }
            });
            $(".ajax-products .products-grid .weltpixel-quickview").each(function(){
                $(this).appendTo($(this).parent().parent().children(".product-item-photo"));
            });
            $('.load-more-area > a').off("click").on("click", function(){
                url = "<?php echo $_portohelper->getBaseLinkUrl()."swporto/index/showcategoryproducts" ?>";
                cat_id = $(this).attr("cat_id");

                $(".ajax-products .load-more-area > .ajax-loader-area").fadeIn();

                $.ajax({
                    method:"POST",
                    url:url,
                    data:{
                        aspect_ratio:"<?php echo $aspect_ratio; ?>",
                        image_width:"<?php echo $image_width; ?>",
                        image_height:"<?php echo $image_height; ?>",
                        product_count:"<?php echo $product_count+$column_count; ?>",
                        columns:"<?php echo $column_count; ?>",
                        category_id:cat_id
                    },
                    dataType: 'json'
                }).done(function(data){
                    $(".ajax-products > .category-detail > .products-area").html(data.result);
                    if($("form[data-role=tocart-form]").length > 0 && !redirect_cart) {
                        $("form[data-role=tocart-form]").catalogAddToCart();
                    }
                }).fail(function(){

                }).always(function(){
                    $(".ajax-products > .category-detail > .ajax_products_loader").fadeOut();
                    if(typeof enable_quickview != 'undefined' && enable_quickview == true) {
                        requirejs(['jquery', 'weltpixel_quickview' ],
                        function   ($, quickview) {
                            $('.weltpixel-quickview').off('click').on('click', function() {
                                var prodUrl = $(this).attr('data-quickview-url');
                                if (prodUrl.length) {
                                    quickview.displayContent(prodUrl);
                                }
                            });
                            $(".ajax-products .products-grid .weltpixel-quickview").each(function(){
                              $(this).parent().parent().addClass('has-quickview');
                              if($(this).parents('.product-type-advanced').find(".product-item-photo.porto-tb-featured-image .icon-absolute").length > 0){
                                $(this).appendTo($(this).parents('.product-type-advanced').find(".product-item-photo .porto-tb-featured-image .product-item-inner .product-item-actions"));
                              }else{
                                $(this).appendTo($(this).parent().parent().children(".product-item-photo"));
                              }
                            });
                        });
                    }
                });
            });
        });</script><?php if (!$block->isRedirectToCartEnabled()) : ?> <script type="text/x-magento-init">
        {
            "[data-role=tocart-form], .form.map.checkout": {
                "catalogAddToCart": {}
            }
        }</script><?php endif; ?> <?php endif; ?>